<% /*
@fileoverview EJS template for adding a new plant to the Plant Sharing Community.
Includes a form with fields for plant details, image upload with preview,
and modals for loading and success feedback.
*/ %>

<!--Plant Form-->
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
            <div class="card shadow">
                <div class="card-header bg-success text-white">
                    <h2 class="mb-0"><i class="bi bi-plus-circle me-2"></i>Add New Plant</h2>
                </div>
                <div class="card-body">
                    <form id="plantForm" enctype="multipart/form-data">
                        <!-- Plant Name -->
                        <div class="mb-3">
                            <label for="plantName" class="form-label">
                                <i class="bi bi-flower1 me-1"></i>Plant Name *
                            </label>
                            <input type="text" 
                                    class="form-control" 
                                    id="plantName" 
                                    name="plantName" 
                                    required
                                    placeholder="Enter the plant's scientific or common name">
                            <div class="invalid-feedback">
                                Please provide a plant name.
                            </div>
                        </div>

                        <!-- Plant Type -->
                        <div class="mb-3">
                            <label for="type" class="form-label">
                                <i class="bi bi-tags me-1"></i>Plant Type *
                            </label>
                            <select class="form-select" id="type" name="type" required>
                                <option value="">Choose a plant type...</option>
                                <option value="succulent">Succulent</option>
                                <option value="fern">Fern</option>
                                <option value="flowering">Flowering Plant</option>
                                <option value="houseplant">Houseplant</option>
                                <option value="herb">Herb</option>
                                <option value="vegetable">Vegetable</option>
                                <option value="other">Other</option>
                            </select>
                            <div class="invalid-feedback">
                                Please select a plant type.
                            </div>
                        </div>

                        <!-- Description -->
                        <div class="mb-3">
                            <label for="description" class="form-label">
                                <i class="bi bi-card-text me-1"></i>Description *
                            </label>
                            <textarea class="form-control" 
                                        id="description" 
                                        name="description" 
                                        rows="4" 
                                        required
                                        placeholder="Describe your plant, its care requirements, growing conditions, etc."></textarea>
                            <div class="invalid-feedback">
                                Please provide a description.
                            </div>
                        </div>

                        <!-- Photo Upload -->
                        <div class="mb-3">
                            <label for="photoID" class="form-label">
                                <i class="bi bi-camera me-1"></i>Plant Photo
                            </label>
                            <input type="file" 
                                    class="form-control" 
                                    id="photoID" 
                                    name="photo" 
                                    accept="image/*">
                            <div class="form-text">
                                Upload a photo of your plant (JPEG, PNG, WebP supported)
                            </div>
                            <div class="invalid-feedback">
                                Please upload a valid image file.
                            </div>
                        </div>

                        <!-- Image Preview -->
                        <div class="mb-3" id="imagePreviewContainer" style="display: none;">
                            <label class="form-label">
                                <i class="bi bi-eye me-1"></i>Preview
                            </label>
                            <div class="border rounded p-3 text-center">
                                <img id="imagePreview" src="" alt="Image preview" class="img-fluid rounded" style="max-height: 300px;">
                            </div>
                        </div>

                        <!-- Nickname -->
                        <div class="mb-4">
                            <label for="nickname" class="form-label">
                                <i class="bi bi-heart me-1"></i>Nickname *
                            </label>
                            <input type="text" 
                                    class="form-control" 
                                    id="nickname" 
                                    name="nickname" 
                                    required
                                    placeholder="Give your plant a fun nickname">
                            <div class="form-text">
                                What do you call your plant? This makes it more personal!
                            </div>
                            <div class="invalid-feedback">
                                Please provide a nickname for your plant.
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="/" class="btn btn-secondary me-md-2">
                                <i class="bi bi-arrow-left me-1"></i>Cancel
                            </a>
                            <button type="submit" class="btn btn-success" id="submitBtn">
                                <i class="bi bi-plus-circle me-1"></i>Add Plant
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading Modal -->
<div class="modal fade" id="loadingModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center py-4">
                <div class="spinner-border text-success me-3" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                Adding your plant...
            </div>
        </div>
    </div>
</div>

<!-- Success Modal -->
<div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center py-4">
                <i class="bi bi-check-circle text-success" style="font-size: 3rem;"></i>
                <h4 class="mt-3 mb-2">Plant Added Successfully!</h4>
                <p class="mb-3">Your plant has been added to the community.</p>
                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                    <a href="/" class="btn btn-success me-md-2">View Collection</a>
                    <button type="button" class="btn btn-outline-success" onclick="window.location.reload()">Add Another</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/javascripts/addPlant/addPlantScript.js"></script>