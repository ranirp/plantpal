<%#
/**
 * @component PlantDetailsComponent
 * @description Displays detailed information about a specific plant
 * 
 * Features:
 * - Full-size plant image with fallback
 * - Plant metadata display (name, type, owner, date)
 * - Description section
 * - Back navigation button
 * - Responsive layout
 * 
 * Required Data:
 * @param {Object} data - Plant data object
 * @param {string} data.photo - Photo filename
 * @param {string} data.plantName - Name of the plant
 * @param {string} data.nickname - Owner's nickname
 * @param {string} data.type - Plant type (succulent, fern, etc.)
 * @param {Date} data.createdAt - Creation timestamp
 * @param {string} data.description - Plant description
 * 
 * Styling:
 * - Glass card effect
 * - Shadow effects
 * - Responsive image sizing
 * - Consistent spacing
 */
%>
<link rel="stylesheet" href="/css/outputStyles.css" />

<div class="card w-full glass rounded-xl overflow-hidden min-h-screen">
    <%# Main container %>
    <div class="relative bg-base-100 px-4 pt-2 pb-2">

        <%# Plant image with fixed aspect ratio container %>
        <div class="mx-auto w-full max-w-xl md:max-w-xl p-4">
            <figure class="relative overflow-hidden rounded-xl border border-base-300 bg-base-200 shadow-md hover:shadow-lg transition-shadow">
                <div class="relative w-full aspect-[4/3] bg-base-300">
                    <img 
                        src="/images/uploads/<%= data.photo %>" 
                        alt="<%= data.plantName %>" 
                        class="absolute inset-0 w-full h-full object-contain"
                        onerror="this.onerror=null;this.src='/images/placeholder.jpg';" 
                        loading="lazy"
                    />
                </div>
            </figure>
        </div>
    </div>

    <%# Plant details content section %>
    <div class="card-body pt-4 bg-base-100 space-y-4 max-w-xl mx-auto w-full">
        <%# Metadata box %>
        <div class="card bg-base-200 shadow-sm">
            <div class="card-body p-4 space-y-4">
                <%# Owner information %>
                <div class="flex items-center gap-2">
                    <div class="w-24 font-bold flex-shrink-0">Created by:</div>
                    <div class="truncate"><%= data.nickname %></div>
                </div>

                <%# Plant type %>
                <div class="flex items-center gap-2">
                    <div class="w-24 font-bold flex-shrink-0">Type:</div>
                    <div class="badge badge-primary capitalize"><%= data.type %></div>
                </div>

                <%# Creation date %>
                <div class="flex items-center gap-2">
                    <div class="w-24 font-bold flex-shrink-0">Added:</div>
                    <div class="text-sm">
                        <%= new Date(data.createdAt).toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        }) %>
                    </div>
                </div>
            </div>
        </div>

        <%# Description box %>
        <div class="card bg-base-200 shadow-sm">
            <div class="card-body p-4">
                <h3 class="font-bold mb-2">Description:</h3>
                <div class="prose max-w-none text-base-content">
                    <%= data.description %>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Optional: Add loaded class when image finishes loading
document.addEventListener('DOMContentLoaded', function() {
    const images = document.querySelectorAll('img[loading="lazy"]');
    
    images.forEach(img => {
        if (img.complete) {
            img.classList.add('loaded');
        } else {
            img.addEventListener('load', function() {
                this.classList.add('loaded');
            });
        }
        
        // Handle error state
        img.addEventListener('error', function() {
            this.classList.add('loaded');
            console.warn('Failed to load image:', this.src);
        });
    });
});
</script>